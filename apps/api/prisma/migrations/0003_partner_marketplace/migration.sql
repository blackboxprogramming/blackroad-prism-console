CREATE TABLE "Partner" ("id" TEXT PRIMARY KEY, "name" TEXT NOT NULL, "email" TEXT NOT NULL, "website" TEXT, "status" TEXT DEFAULT 'pending', "createdAt" DATETIME DEFAULT CURRENT_TIMESTAMP);
CREATE TABLE "PartnerApp" ("id" TEXT PRIMARY KEY, "partnerId" TEXT NOT NULL, "name" TEXT NOT NULL, "slug" TEXT UNIQUE NOT NULL, "scopes" TEXT NOT NULL, "webhookUrl" TEXT, "clientId" TEXT UNIQUE NOT NULL, "clientSecret" TEXT NOT NULL, "approved" BOOLEAN DEFAULT 0, "visible" BOOLEAN DEFAULT 0, "createdAt" DATETIME DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY("partnerId") REFERENCES "Partner"("id") ON DELETE CASCADE);
CREATE TABLE "OAuthToken" ("id" TEXT PRIMARY KEY, "appId" TEXT NOT NULL, "orgId" TEXT NOT NULL, "scope" TEXT NOT NULL, "accessToken" TEXT UNIQUE NOT NULL, "refreshToken" TEXT, "expiresAt" DATETIME NOT NULL, "createdAt" DATETIME DEFAULT CURRENT_TIMESTAMP);
CREATE TABLE "AppInstall" ("id" TEXT PRIMARY KEY, "appId" TEXT NOT NULL, "orgId" TEXT NOT NULL, "plan" TEXT NOT NULL DEFAULT 'STARTER', "installedAt" DATETIME DEFAULT CURRENT_TIMESTAMP, "uninstalledAt" DATETIME, FOREIGN KEY("appId") REFERENCES "PartnerApp"("id") ON DELETE CASCADE);
CREATE TABLE "RevenueShareReport" ("id" TEXT PRIMARY KEY, "month" TEXT NOT NULL, "appId" TEXT NOT NULL, "installId" TEXT NOT NULL, "usage" INTEGER DEFAULT 0, "amountUsd" REAL DEFAULT 0, "createdAt" DATETIME DEFAULT CURRENT_TIMESTAMP);

model:
  name: br-sprout-350m
  d_model: 1024
  n_layers: 24
  n_heads: 16
  n_kv_heads: 8
  ffn_mult: 3.5
  vocab_size: 32000
  max_position_embeddings: 8192
  rope_theta: 1000000
  dropout: 0.0
optimizer:
  name: adamw
  lr: 0.00025
  betas: [0.9, 0.95]
  weight_decay: 0.1
  eps: 1.0e-8
scheduler:
  name: cosine
  warmup_steps: 12000
  total_steps: 500000
  min_lr_ratio: 0.05
training:
  precision: bf16
  grad_clip: 1.0
  gradient_accumulation_steps: 16
  micro_batch_size: 8
  global_batch_tokens: 6000000
  seq_length: 8192
  checkpoint_every: 1000
  eval_every: 5000
  save_milestones: [250000, 400000, 500000]
datasets:
  manifest: ../../data/manifests/sprout.json
  pack_sequences:
    max_tokens: 8192
    spillover_tolerance: 0.05
logging:
  run_card: ../../data/run_cards/sprout.json
  reflex_topic: inference.sprout

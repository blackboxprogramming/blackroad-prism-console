name: Cosign Sign (optional)
on:
  workflow_run:
    workflows: ['Container â€” Build & Push (GHCR)']
    types: [completed]
permissions:
  contents: read
  packages: write
jobs:
  sign:
    if: ${{ secrets.COSIGN_KEY != '' }}
    runs-on: ubuntu-latest
    steps:
      - name: Install cosign
        run: sudo apt-get update && sudo apt-get install -y cosign || true
      - name: Sign latest image (placeholder tag)
        env:
          COSIGN_PASSWORD: ${{ secrets.COSIGN_PASSWORD }}
        run: |
          IMAGE="ghcr.io/${{ github.repository_owner }}/blackroad:${{ github.sha }}"
          cosign sign --key env://COSIGN_KEY "$IMAGE" || true

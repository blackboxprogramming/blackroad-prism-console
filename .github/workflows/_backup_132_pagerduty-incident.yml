name: PagerDuty Incident (manual)
on:
  workflow_dispatch:
    inputs:
      summary: { required: true, description: 'Incident summary' }
permissions: {}
jobs:
  page:
    runs-on: ubuntu-latest
    steps:
      - name: Trigger incident
        env:
          PD_ROUTING_KEY: ${{ secrets.PD_ROUTING_KEY }}
        run: |
          if [ -z "$PD_ROUTING_KEY" ]; then echo "No PD key"; exit 0; fi
          curl -s https://events.pagerduty.com/v2/enqueue \
            -H 'Content-Type: application/json' \
            -d '{"routing_key":"'"$PD_ROUTING_KEY"'","event_action":"trigger","payload":{"summary":"'"${{ inputs.summary }}"'","severity":"error","source":"github-actions"}}'

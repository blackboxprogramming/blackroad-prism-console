name: Gitleaks (secrets scan)
on: { pull_request: {}, workflow_dispatch: {} }
permissions: { contents: read }
jobs:
  scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Gitleaks via Docker (skip-safe)
        run: |
          docker --version >/dev/null 2>&1 || { echo "::notice::Docker missing; skipping"; exit 0; }
          docker run --rm -v "$PWD:/repo" zricethezav/gitleaks:latest detect -s /repo --no-git -v --redact --exit-code 0 || true

name: ChatOps: Snapshot
on: { issue_comment: { types: [created] } }
permissions: { actions: write, pull-requests: write }
jobs:
  snap:
    if: startsWith(github.event.comment.body, '/snapshot')
    runs-on: ubuntu-latest
    steps:
      - uses: actions/github-script@v7
        with:
          script: |
            try {
              await github.actions.createWorkflowDispatch({
                owner: context.repo.owner,
                repo: context.repo.repo,
                workflow_id: 'cache-warm-shot.yml',
                ref: context.payload.repository.default_branch
              });
              await github.issues.createComment({owner: context.repo.owner, repo: context.repo.repo, issue_number: context.payload.issue.number, body: "üñºÔ∏è Snapshot job dispatched."});
            } catch (e) {
              await github.issues.createComment({owner: context.repo.owner, repo: context.repo.repo, issue_number: context.payload.issue.number, body: "Failed to dispatch snapshot: " + e.message});
            }

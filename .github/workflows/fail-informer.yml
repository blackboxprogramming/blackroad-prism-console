name: Fail Informer
on:
  workflow_run:
    workflows: ["Deploy Quantum App (safe)", "Super-Linter", "CodeQL", "Snyk Scan", "OSSF Scorecard"]
    types: [completed]
permissions:
  pull-requests: write
  actions: read
jobs:
  comment:
    if: ${{ github.event.workflow_run.conclusion == 'failure' }}
    runs-on: ubuntu-latest
    steps:
      - uses: actions/github-script@v7
        with:
          script: |
            const run = context.payload.workflow_run;
            const prs = run.pull_requests || [];
            if (!prs.length) { core.info('No associated PR; nothing to comment.'); return; }
            const {owner, repo} = context.repo;
            for (const pr of prs) {
              await github.issues.createComment({
                owner, repo, issue_number: pr.number,
                body: `‚ùå **${run.name}** failed on \`${run.head_branch}\`.\n\nLogs: ${run.html_url}`
              });
            }


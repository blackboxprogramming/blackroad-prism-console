name: Flags
on:
  workflow_call:
    outputs:
      ai_tools:
        description: 'ai_tools flag'
        value: ${{ jobs.flags.outputs.ai_tools }}
      security_scans:
        description: 'Security scans flag'
        value: ${{ jobs.flags.outputs.security_scans }}
      web_performance:
        description: 'Web perf flag'
        value: ${{ jobs.flags.outputs.web_performance }}
      heavy_linters:
        description: 'Heavy linters flag'
        value: ${{ jobs.flags.outputs.heavy_linters }}
jobs:
  flags:
    runs-on: ubuntu-latest
    outputs:
      ai_tools: ${{ steps.f.outputs.ai_tools }}
      security_scans: ${{ steps.f.outputs.security_scans }}
      web_performance: ${{ steps.f.outputs.web_performance }}
      heavy_linters: ${{ steps.f.outputs.heavy_linters }}
    steps:
      - uses: actions/checkout@08eba0b27e820071cde6df949e0beb9ba4906955 # v4
      - id: f
        run: |
          file=".github/feature-flags.yml"
          ai=$(grep -E '^ai_tools:' "$file" | awk '{print $2}')
          sec=$(grep -E '^security_scans:' "$file" | awk '{print $2}')
          wp=$(grep -E '^web_performance:' "$file" | awk '{print $2}')
          hl=$(grep -E '^heavy_linters:' "$file" | awk '{print $2}')
          echo "ai_tools=${ai:-false}" >> $GITHUB_OUTPUT
          echo "security_scans=${sec:-false}" >> $GITHUB_OUTPUT
          echo "web_performance=${wp:-false}" >> $GITHUB_OUTPUT
          echo "heavy_linters=${hl:-false}" >> $GITHUB_OUTPUT

name: Lighthouse CI (blackroad)
on:
  pull_request:
  workflow_dispatch: {}
permissions: { contents: read }
jobs:
  lhci:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@08eba0b27e820071cde6df949e0beb9ba4906955 # v4
      - name: Build site (if present)
        run: |
          if [ -d sites/blackroad ]; then
            cd sites/blackroad && npm ci --omit=optional || npm i --package-lock-only
            npm run build
          else
            echo "No site; skipping." >> $GITHUB_STEP_SUMMARY
          fi
      - name: Run Lighthouse
        if: ${{ hashFiles('sites/blackroad/dist/**') != '' }}
        uses: treosh/lighthouse-ci-action@v12
        with:
          configPath: sites/blackroad/.lighthouserc.json
          uploadArtifacts: true
          temporaryPublicStorage: true

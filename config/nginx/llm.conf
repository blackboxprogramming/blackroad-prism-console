server {
    listen 80;
    server_name YOUR_DOMAIN;  # replace

    add_header Content-Security-Policy "default-src 'self'; \
  base-uri 'self'; frame-ancestors 'none'; object-src 'none'; \
  script-src 'self' 'nonce-$csp_nonce' 'strict-dynamic' https:; \
  style-src 'self' 'nonce-$csp_nonce' 'unsafe-inline'; \
  img-src 'self' https: data:; connect-src 'self' https: wss:; \
  font-src 'self' https:" always;

    location /openwebui/ {
        proxy_pass http://127.0.0.1:3000/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-CSP-Nonce $csp_nonce;
    }

    location /v1/ {
        proxy_pass http://127.0.0.1:8000/v1/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-CSP-Nonce $csp_nonce;
    }

    location /ollama/ {
        proxy_pass http://127.0.0.1:11434/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-CSP-Nonce $csp_nonce;
    }

    include snippets/lucidia_api.conf;
}


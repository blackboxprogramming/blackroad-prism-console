global:
  resolve_timeout: 5m

route:
  receiver: slack

receivers:
  - name: 'slack'
    slack_configs:
      - api_url: ${SLACK_WEBHOOK_URL}
        channel: '#dev-ops'
        send_resolved: true
        title: "[{{ .Status | toUpper }}] {{ .CommonLabels.alertname }}"
        title_link: "https://grafana.blackroadinc.us/d/alerts"
        icon_emoji: ":satellite_antenna:"
        blocks:
          - type: section
            text:
              type: mrkdwn
              text: "*{{ .CommonAnnotations.summary }}*\n{{ .CommonAnnotations.description }}"
          - type: context
            elements:
              - type: mrkdwn
                text: "*Severity:* {{ .CommonLabels.severity | toUpper }}"
              - type: mrkdwn
                text: "*Service:* {{ .CommonLabels.job }}"
              - type: mrkdwn
                text: "*Instance:* {{ .CommonLabels.instance }}"
          - type: divider
          - type: section
            fields:
              - type: mrkdwn
                text: "*Started:* {{ .StartsAt }}"
              - type: mrkdwn
                text: "*Ends:* {{ .EndsAt | default \"N/A\" }}"
          - type: actions
            elements:
              - type: button
                text:
                  type: plain_text
                  text: "ðŸ§  Open Grafana"
                url: "https://grafana.blackroadinc.us/d/system-metrics"
              - type: button
                text:
                  type: plain_text
                  text: "ðŸ›  View Logs"
                url: "https://grafana.blackroadinc.us/explore"
              - type: button
                text:
                  type: plain_text
                  text: "ðŸ“¦ Trigger Redeploy"
                url: "https://github.com/blackboxprogramming/blackroad-prism-console/actions"

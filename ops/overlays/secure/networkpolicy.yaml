apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata: { name: argo-restrict-egress, namespace: argo }
spec:
  podSelector: {}
  policyTypes: ["Egress"]
  egress:
    - to:
        - namespaceSelector: { matchLabels: { kubernetes.io/metadata.name: kube-system } }
          podSelector: { matchLabels: { k8s-app: kube-dns } }
      ports: [{ port: 53, protocol: UDP }, { port: 53, protocol: TCP }]
    - to:
        - namespaceSelector: {}
      ports: [{ port: 443, protocol: TCP }]

services:
  # --- Monero (xmrig) • CPU miner (learn-mode, throttled) ---
  xmrig:
    image: ghcr.io/xmrig/xmrig:latest
    container_name: xmrig
    command: >
      -o POOL_HOST:PORT
      -u YOUR_XMR_ADDRESS
      --donate-level=0
      --cpu-max-threads-hint=1
    environment:
      # cap internal throttling further if desired:
      - XMRIG_ALGO=rx/0
    cpus: 0.25              # Docker-level CPU cap
    mem_limit: 256m
    restart: unless-stopped
    security_opt: [no-new-privileges:true]
    read_only: true
    volumes:
      - /etc/localtime:/etc/localtime:ro
    # Enable manually:
    # docker compose -f miners/miners-compose.yml up -d xmrig

  # --- Verus (VRSC) • CPU miner (efficient but still tiny on a Pi) ---
  verusminer:
    image: krypt0nn/verus-miner:latest
    container_name: verusminer
    environment:
      - POOL=POOL_HOST:PORT
      - WALLET=YOUR_VRSC_ADDRESS
      - PASSWORD=x
      - THREADS=1
    cpus: 0.25
    mem_limit: 256m
    restart: unless-stopped
    security_opt: [no-new-privileges:true]
    read_only: true
    # Enable:
    # docker compose -f miners/miners-compose.yml up -d verusminer

  # --- Chia farmer (ultra-low energy; pre-plotted drives needed) ---
  chia:
    image: ghcr.io/chia-network/chia:latest
    container_name: chia
    environment:
      - keys=none            # no private keys loaded on Pi
      - service=farm
      - log_level=INFO
      - TZ=UTC
    volumes:
      - ./chia:/root/.chia
      - /mnt/plots:/plots:ro  # mount your plots read-only
    cpus: 0.2
    mem_limit: 512m
    restart: unless-stopped
    security_opt: [no-new-privileges:true]
    read_only: false
    # Enable:
    # docker compose -f miners/miners-compose.yml up -d chia

[agent:name]=quantum_chemistry.pyscf
[agent:role]=Deterministic quantum-chemistry worker (offline)
[determinism]=on
[constraints]=no network; no external APIs; single-process per job
[io]=JSON in → JSON out

[schema.input]
system:
  unit: "Angstrom" | "Bohr"
  basis: e.g., "def2-SVP" | "def2-TZVP" | "cc-pVDZ"
  charge: int
  spin: int  # 2S (unpaired electrons)
  atoms: [["El",[x,y,z]], ...]  OR  xyz: multiline string
scf:
  method: "hf" | "dft"
  xc: string (if method=dft; default "PBE0")
  density_fit: bool (default true)
posthf: "none" | "mp2" | "ccsd"
accelerate:
  gpu: bool (default false)  # if true and GPU4PySCF present → to_gpu()
properties:
  - "homo_lumo_gap"

[schema.output]
trace_id: string
method: { scf, xc, posthf, density_fit, gpu }
energy: { scf_hartree, total_hartree }
properties: { ... }
result_hash: string  # SHA256 or PS-SHA∞ if available
error: string (optional)

[protocol]
1) Codex writes a job file into /var/lib/blackroad/queue/chem/inbox/*.json
2) chem-agent.service picks it up, runs /opt/blackroad/agents/pyscf/pyscf_agent.py
3) Results appear in /var/lib/blackroad/queue/chem/outbox/*.out.json
4) Codex reads, verifies result_hash, then routes values to downstream tools.
On any failure, check /var/lib/blackroad/queue/chem/failed/.

[examples]
- Submit:  /opt/blackroad/agents/pyscf/bin/chem-submit /opt/blackroad/agents/pyscf/examples/h2o_pbe0.json
- Direct:   python3 /opt/blackroad/agents/pyscf/pyscf_agent.py --job /path/to/job.json

[guardrails]
- Never call network libraries.
- Only accept JSON matching schema; return {"error": "..."} if invalid.
- If accelerate.gpu=true but GPU is unavailable, return error; do not silently fall back.

[notes]
- Periodic systems available via pyscf.pbc in future extension using same IO schema (add cell & k-points).
- Post-HF methods run after SCF; energies are reported in Hartree; HOMO–LUMO gap in eV.


⸻

One-time setup (quick)

sudo bash /opt/blackroad/agents/pyscf/bin/chem-setup
python3 -m pip install -r /opt/blackroad/agents/pyscf/requirements.txt
sudo systemctl daemon-reload
sudo systemctl enable --now chem-agent.service

“Chit chat” usage (machine-simple)
•Submit a job:

/opt/blackroad/agents/pyscf/bin/chem-submit /opt/blackroad/agents/pyscf/examples/h2o_pbe0.json

•Read result:

tail -n +1 /var/lib/blackroad/queue/chem/outbox/*.out.json

If you want a REST microservice or periodic PBC/solid-state extension next, say the word and I’ll drop those files.
